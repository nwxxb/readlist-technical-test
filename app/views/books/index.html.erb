<%= render "application/user_navbar" %>
<main class="container">
  <h1 class="mt-4">Welcome <%= current_user.username %> To Readlist</h1>
  <h2 class="mt-4">Books Table</h2>
  <div class="row row-cols-1 row-cols-md-2 mt-4 text-center">
    <div class="col">
      <div class="card mb-4 rounded-3 shadow-sm">
        <div class="card-header py-3">
          <p class="my-0 fw-normal">Total Books Count</p>
        </div>
        <div class="card-body">
          <p class="card-title h1"><%= pluralize @books.count, 'book' %></p>
        </div>
      </div>
    </div>
    <div class="col">
      <div class="card mb-4 rounded-3 shadow-sm">
        <div class="card-header py-3">
          <p class="my-0 fw-normal">Current Authors Count</p>
        </div>
        <div class="card-body">
          <p class="card-title h1"><%= pluralize @authors_count, 'author' %></p>
        </div>
      </div>
    </div>
  </div>
  <div class="accordion accordion-flush border rounded-3 shadow-sm" id="accordionFlushExample">
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
          <span class="h5"><i class="bi bi-filetype-json"></i> JSON API</span>
        </button>
      </h2>
      <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
        <div class="accordion-body">
          Our JSON API allows you to easily access our books. Simply make a GET request to the following URL:
          <ul>
            <li><code><%= books_json_url %></code></li>
            <li><code><%= book_json_url(":id") %></code></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <table class="mt-4 table table-striped table-hover table-bordered">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Title</th>
        <th scope="col">Description</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
    <% @books.each_with_index do |book, idx| %>
      <tr>
        <th scope="row"><%= idx + 1 %></th>
        <td><%= book.title %></td>
        <td><%= 
        truncate(
            book.description, 
            length: 80,
            separator: ' '
          )
        %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</main>
